ğŸ§¬ **å®ä¹ æ—¥å¿— ç¬¬27å¤©ï½œç»„è£…ç»“æœæ£€æŸ¥ + IGVéªŒè¯ + BLASTå‡†å¤‡**
**æ—¥æœŸï¼š2025å¹´8æœˆ22æ—¥ï¼ˆå‘¨äº”ï¼‰**
**åœ°ç‚¹ï¼šé¦–éƒ½åŒ»ç§‘å¤§å­¦ç”Ÿä¿¡å®éªŒå®¤ï¼ŒiTerm2 + IGV**

---

ğŸ’¡ **ä»Šæ—¥å®Œæˆçš„å·¥ä½œï¼š**

**1. ç»„è£…ç»“æœæ£€æŸ¥ä¸æ˜ å°„éªŒè¯**

* é‡æ–°æ£€æŸ¥äº† `contigs.fasta` çš„é•¿åº¦åˆ†å¸ƒï¼Œç¡®è®¤ä¸»è¦ contig çš„é•¿åº¦å’Œè¦†ç›–æƒ…å†µï¼›
* ç”¨ `bwa mem` å°† contig æ˜ å°„å›å‚è€ƒåŸºå› ç»„ï¼Œç”Ÿæˆæ–°çš„ `contigs_retry2.bam` æ–‡ä»¶ï¼›
* åœ¨ Linux ä¸‹ç”¨ `samtools flagstat` å’Œ `idxstats` æŸ¥çœ‹åŸºæœ¬ç»Ÿè®¡ï¼Œç¡®è®¤æœ‰ reads æˆåŠŸæ¯”å¯¹åˆ° `chr17`ã€‚

**2. IGV å¯è§†åŒ–éªŒè¯**

* åœ¨ IGV é‡ŒåŒæ—¶åŠ è½½åŸå§‹ realign åçš„ BAM æ–‡ä»¶å’Œ contig æ˜ å°„ç»“æœï¼›
* è§‚å¯Ÿåˆ° contig ç¡®å®å¯¹é½åˆ°äº†ç›®æ ‡åŒºåŸŸï¼Œè™½ç„¶è¦†ç›–åº¦ä¸é«˜ï¼Œä½†è¯´æ˜ç»„è£…å‡ºçš„åºåˆ—èƒ½å¯¹åº”åˆ° chr17 ä¸Šï¼ŒåŸºæœ¬éªŒè¯äº†ç»„è£…æ˜¯æˆåŠŸçš„ï¼›
* å‘ç°å’ŒåŸå§‹ reads çš„è¦†ç›–æƒ…å†µå¯¹æ¯”æ—¶ï¼Œcontig æ˜ å°„æ¯”è¾ƒç¨€ç–ï¼Œè¿™æç¤ºç»„è£…ç»“æœéœ€è¦ç»“åˆæ›´å¤šæ•°æ®æˆ–åšè¿›ä¸€æ­¥ä¼˜åŒ–ã€‚

**3. BLAST å‡†å¤‡**

* åˆ¶å®šäº†å°† contigs/junction åºåˆ—è·‘ BLASTN çš„è®¡åˆ’ï¼Œè¾“å‡º `.tsv` ç»“æœå†è½¬ä¸º `.bed` æ–‡ä»¶ï¼Œä»¥ä¾¿åœ¨ IGV ä¸­è¿›ä¸€æ­¥éªŒè¯ï¼›
* å­¦ä¹ äº† BLAST è¾“å‡ºå’Œ BED æ ¼å¼çš„è½¬æ¢è§„åˆ™ï¼Œæ‰“é€šäº†ä»åºåˆ—æ¯”å¯¹åˆ°å¯è§†åŒ–çš„ä¸€æ¡å®Œæ•´æ€è·¯ã€‚

---

ğŸ“š **ä»Šæ—¥æ”¶è·ï¼š**

* é€šè¿‡ Linux ä¸‹çš„ `samtools` å’Œ IGV çš„ç›´è§‚å±•ç¤ºï¼Œå®Œæˆäº†å¯¹ç»„è£…ç»“æœçš„åˆæ­¥éªŒè¯ï¼Œå¢å¼ºäº†è‡ªå·±å¯¹â€œç»„è£…â€”æ¯”å¯¹â€”å¯è§†åŒ–â€è¿™ä¸€æµç¨‹çš„ç†è§£ï¼›
* å­¦ä¼šäº†å¦‚ä½•ä» BLAST ç»“æœç”Ÿæˆ BED æ–‡ä»¶ï¼Œè¿™ä¸ºåç»­çš„åŠŸèƒ½éªŒè¯å’Œè·¨æ•°æ®åº“å¯¹ç…§æä¾›äº†å·¥å…·ï¼›
* è®¤è¯†åˆ°å®é™…éªŒè¯ä¸ä»…è¦çœ‹ç»Ÿè®¡æ•°å­—ï¼Œæ›´è¦ç»“åˆ IGV ç­‰å¯è§†åŒ–å·¥å…·å»ç›´è§‚æ¯”å¯¹ã€‚

---

â— **ä¸è¶³ä¸åæ€ï¼š**

* contig æ•°é‡å’Œè¦†ç›–åº¦åä½ï¼Œè¯´æ˜ç»„è£…çš„ç‰‡æ®µæœ‰é™ï¼Œåç»­å¯èƒ½éœ€è¦ä¼˜åŒ–ç»„è£…å‚æ•°æˆ–ä½¿ç”¨æ›´é«˜è´¨é‡çš„æ•°æ®ï¼›
* å¯¹ BLAST æ•°æ®åº“çš„ä½¿ç”¨è¿˜ä¸å¤Ÿç†Ÿæ‚‰ï¼Œå°¤å…¶æ˜¯æœ¬åœ° nt æ•°æ®åº“çš„ç®¡ç†ä¸æ›´æ–°ï¼Œéœ€è¦èŠ±æ—¶é—´å»æŒæ¡ï¼›
* IGV çš„å¯è§†åŒ–èƒ½ç›´è§‚è¯´æ˜é—®é¢˜ï¼Œä½†å®šé‡åˆ†æä¸è¶³ï¼Œåé¢è¿˜éœ€è¦åœ¨ Linux ä¸‹åšæ›´ä¸¥æ ¼çš„ç»Ÿè®¡ã€‚

---

ğŸ“ **å‘¨æ€»ç»“ï¼ˆç¬¬4å‘¨ï¼‰ï¼š**

* æœ¬å‘¨ä¸»è¦è¿›å±•æ˜¯é€æ­¥å®Œæˆäº†ä»åŸå§‹ reads åˆ°ç»„è£…ã€æ¯”å¯¹ã€å†åˆ° IGV éªŒè¯çš„ä¸€æ•´å¥—æµç¨‹ï¼Œå»ºç«‹äº†å¯¹æ•´ä¸ªå®éªŒé€»è¾‘çš„æ¸…æ™°è®¤è¯†ï¼›
* æŒæ¡äº† Linux ä¸‹å¸¸ç”¨çš„éªŒè¯æ–¹æ³•ï¼ˆflagstatã€idxstatsã€depthï¼‰å’Œå¯è§†åŒ–æ‰‹æ®µï¼ˆIGVï¼‰ï¼Œä¹Ÿå¼€å§‹å°è¯•å°† BLAST å¼•å…¥éªŒè¯ç¯èŠ‚ï¼›
* è‡ªèº«ä¸è¶³åœ¨äºå¯¹åº•å±‚ç®—æ³•çš„ç†è§£è¿˜æ¯”è¾ƒæµ…ï¼Œæ¯”å¦‚ä¸ºä»€ä¹ˆæŸäº› contig æ˜ å°„ç¨€ç–ã€ç»„è£…å¤±è´¥çš„æ½œåœ¨åŸå› ï¼Œéœ€è¦æ›´å¤šæ–‡çŒ®å­¦ä¹ ï¼›
* ä¸‹å‘¨é‡ç‚¹ï¼š

  * å®Œæˆ BLASTN â†’ BED â†’ IGV çš„éªŒè¯é“¾è·¯ï¼›
  * è¿›ä¸€æ­¥æ€è€ƒå¦‚ä½•ä¼˜åŒ–ç»„è£…ï¼Œæå‡ contig æ•°é‡å’Œè¦†ç›–åº¦ï¼›
  * å¼€å§‹æ€»ç»“è¿™æ®µæµç¨‹ï¼Œå½¢æˆä¸€ä¸ªå¯å¤ç”¨çš„ SOP æ–‡æ¡£ã€‚

 ---
 
 **ä»Šæ—¥ä½¿ç”¨çš„ä»£ç ç‰‡æ®µ**
 
# 1) æŸ¥çœ‹ contig é•¿åº¦åˆ†å¸ƒï¼ˆåˆ—å‡ºå‰ 20 æ¡æœ€é•¿ï¼‰
awk '/^>/{if(seq){print id, length(seq)}; id=$0; seq=""; next}{seq=seq $0}END{if(seq)print id, length(seq)}' \
  /public/home/shenyz/genome/spades_region_out_retry2/contigs.fasta | sort -k2,2nr | head -n 20


# 2) å°† contigs æ˜ å°„å›å‚è€ƒåŸºå› ç»„ï¼Œç”Ÿæˆ BAM æ–‡ä»¶
bwa mem -t 12 modified_genome.fa /public/home/shenyz/genome/spades_region_out_retry2/contigs.fasta | \
  samtools sort -@8 -o /public/home/shenyz/genome/contigs_retry2.bam

# 3) å»ºç«‹ BAM ç´¢å¼•
samtools index /public/home/shenyz/genome/contigs_retry2.bam


# 4) æŸ¥çœ‹ BAM çš„åŸºæœ¬ç»Ÿè®¡ä¿¡æ¯
samtools flagstat /public/home/shenyz/genome/contigs_retry2.bam


# 5) æŸ¥çœ‹æ¯æ¡æŸ“è‰²ä½“çš„æ¯”å¯¹æƒ…å†µï¼ˆæŒ‰æ¯”å¯¹æ•°æ’åºï¼‰
samtools idxstats /public/home/shenyz/genome/contigs_retry2.bam | sort -k3,3nr | head -n 40


