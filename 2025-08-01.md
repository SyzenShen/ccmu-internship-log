🧬 **实习日志 第20天｜插入脚本逻辑优化与病毒序列替换验证**
**日期：2025年8月1日**
**地点：首都医科大学生信实验室，服务器终端（iTerm2）**

---

💡 **今日完成的工作：**

### 1. 病毒基因组插入工具优化

* **问题分析**：原脚本在 IGV 查看时，插入位置（chr17:40332557-40333012）存在空缺区域，说明插入逻辑有问题。
* **核心修改**：改为**固定删除28bp区域**（40332557-40332584），不再根据病毒长度动态调整切除范围。
* **关键调整**：

  * 插入点位置由用户指定，病毒序列插入在 40332556 之后。
  * 删除区域长度保持不变，确保病毒序列直接替代原序列。

---

### 2. python程序功能升级

* 新增严格坐标验证逻辑，防止用户输入不合法坐标导致脚本报错。
* 精简并明确基因组处理流程，使用清晰的序列拼接方式：

  ```python
  left_part = record.seq[:start-1]
  right_part = record.seq[end:]
  new_seq = left_part + virus_seq + right_part
  ```
* 输出插入长度差异，便于后续分析比对是否一致：

  ```python
  length_diff = virus_length - (end - start + 1)
  print(f"长度变化: {length_diff:+}bp")
  ```

---

### 3. 测试与验证准备

* 使用以下指令测试新脚本逻辑：

  ```bash
  python insert_virus.py GRCh38.fa EBV.fa modified.fa chr17 40332557 40332584
  ```
* 测试结果：

  * 删除区域：28bp
  * 插入序列长度：1126bp
  * 染色体长度增加：+1098bp
* 输出 `modified.fa` 成功生成，内容结构正确，准备下周进行 IGV 比对验证。

---

### 4. 脚本文档完善

* 补充了每个参数的解释和使用示例；
* 记录了修改逻辑及生信流程中的注意事项，方便未来维护和复用。

---

📌 **今日小结：**

今天主要优化了病毒插入脚本的切除和插入逻辑，确保替换区域精确、序列拼接连续，为后续比对分析打好基础。目前 IGV 验证尚未进行，预计下周一查看插入效果是否符合预期，再继续下一步分析。然后今天读了大量的论文，英文阅读速度有很大的变化。
