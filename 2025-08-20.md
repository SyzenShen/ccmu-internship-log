🧬 **实习日志 第24天｜Fastq截取 + SPAdes组装验证 + IGV可视化**
**日期：2025年8月20日**
**地点：首都医科大学生信实验室，iTerm2 + IGV**

---

💡 **今日完成的工作：**

**1. 目标区域fastq截取与处理**

* 根据昨天确认的TTMV拼接区域，截取了检测基因组中40332457–40333785区间的reads；
* 对两对fastq文件分别执行了samtools view → samtools fastq流程，成功生成R1、R2和singletons文件；
* 注意到在处理过程中丢弃了大部分singletons（zzq样本丢弃951条，zzq2样本丢弃819条），明确记录了这一现象，理解这是paired-end数据截取后单端reads缺失导致的正常情况；
* 对两对reads进行了合并准备，用于SPAdes组装，确保覆盖完整目标区域。

**2. SPAdes组装目标片段**

* 使用合并后的R1、R2文件进行SPAdes组装，并单独加入singletons作为补充；
* 解决了之前在参数使用上的问题（去掉`--careful`和`--isolate`冲突，保证命令可执行）；
* 生成了目标区域的contigs.fasta文件，为后续比对做准备。

**3. IGV比对与BED可视化**

* 将组装得到的contig用blastn比对到chr17参考基因组，输出表格格式；
* 将blastn结果转换为BED文件，包括strand、bitscore信息，方便在IGV中可视化；
* 在IGV中加载BED文件与原始BAM文件，成功观察到目标区域的reads与组装序列基本对齐，验证了组装结果的可靠性；
* 通过颜色和条块直观对比，确认了40333285–40333350区域的空缺确实是参考基因组缺失，而非组装问题。

**4. 今天还部署了本地的生物信息学环境，安装了homebrew等，一波三折**

---

📚 **工作总结：**

**技术能力提升方面**

* 熟练完成目标区域fastq截取、R1/R2合并和SPAdes组装，解决了多次参数冲突问题；
* 学会使用blastn + BED文件在IGV中可视化比对结果，为验证组装提供直观方法；
* 明确了paired-end reads在截取和转换过程中的singletons丢失规律，理解了数据完整性与可视化的关系。

**科研思维与问题意识**

* 能够清晰区分“参考基因组缺失 vs 检测基因组存在”，并据此调整分析策略；
* 通过可视化验证组装结果，形成了“截取→组装→比对→观察”的闭环思路；
* 逐步养成边操作边记录问题的习惯，为后续分析积累经验。

---

❗ **当前存在的问题与思考：**

* singletons丢失较多，虽然不影响当前目标，但需要理解其对更大区域组装的潜在影响；
* SPAdes组装仍依赖参数选择和reads覆盖情况，对小片段或低深度区域可能出现缺失；
* IGV观察时，对颜色和条块含义的理解还需进一步熟练，以便快速判断组装正确性。

---

🎯 **明日计划：**

* 编写更通用的fastq截取脚本，支持多样本批量处理，自动生成SPAdes输入文件；
* 尝试对更多目标片段做同样的截取-组装-比对流程，验证方法稳定性；
* 深入理解singletons丢失原因及对组装策略的影响，优化处理方法；
* 整理今天生成的BED文件、组装contigs和可视化流程，形成操作模板，方便后续快速验证实验数据。
