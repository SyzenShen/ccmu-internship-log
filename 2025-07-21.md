🧬 实习日志 第11天｜Delly结构变异检测初步完成 + 多线程验证 + Linux操作进一步熟练
日期：2025年7月21日
地点：首都医科大学生信实验室，服务器终端（MobaXterm）

---

💡 今日完成的工作：

**1. Delly结构变异检测流程初步完成**

* 成功完成Delly程序的上传、授权及运行测试，掌握了基本用法；
* 使用 `scp` 指令将本地文件上传至服务器，并使用 `chmod +x` 赋予执行权限；
* 利用 `./delly_v1.3.3_linux_x86_64bit call` 对 `.bam` 文件进行结构变异检测，完成基础流程；
* 尝试了使用 `OMP_NUM_THREADS=12` 启动多线程，但由于Delly为预编译程序，多线程并未生效，经导师确认为设计限制；
* 重点针对 `SVTYPE=INS` 插入变异进行单独检测，调整参数 `-t INS` 成功运行程序；
* 使用 `bcftools view` 精确提取 `SVTYPE="BND"` 和 `CHROM=="chr17"` 的结果，用于后续验证。

**2. 比对文件重新生成并格式标准化**

* 重新使用 `bwa mem -t 12` 对原始序列与拼接参考基因组进行比对，去除 `-p -s` 参数以避免对齐异常；
* 采用 `samtools sort -@ 12` 进行 `.sam` 文件排序生成 `.bam`，并再次运行结构变异检测；
* 通过 `ll -rth` 指令确认排序后文件大小正常，确保输入文件有效；
* 比对结果中未发现病毒参考序列相关变异，已记录输出供后续分析。

**3. 文件提取与可视化准备**

* 使用 `bcftools` 筛选结构变异结果中的BND区域并提取特定染色体，准备后续IGV联合可视化；
* 明确结构变异检测结果不能仅以病毒序列显示为依据，需结合人类染色体（如chr17）共同定位，增强结果解释力。

---

📌 技术进展：

* 掌握了Delly工具的基本使用方法，能够进行结构变异检测的完整流程；
* 熟悉了上传、赋权、执行、筛选等一系列Linux操作，提升了远程服务器使用效率；
* 初步掌握 `bcftools view` 中表达式筛选的语法规则；
* 明确了多线程运行的局限性和原理，提升对软件运行机制的理解；
* 理解了结构变异检测结果的解释方式，尤其是与病毒片段比对中的解读要求；
* 新电脑很给力，所有的操作都很顺利，所有配置的环境和权限都很干净，目前熟练且效率高。

---

❗ 当前存在的问题：

* Delly检测结果未能在病毒参考序列上获得有效变异，待明日通过新提供的参考序列再次验证；
* 尚未掌握如何高效使用Delly进行跨染色体结构变异分析；
* IGV与结构变异结果联动尚未测试，需尽快完成 `.vcf` 与 `.bam` 的联合可视化；
* BCF与VCF格式的转换与解读机制仍需深入理解；
* 对于结构变异类型如INS、BND的判读能力仍有待加强。

---

🎯 明日计划：

* 使用新提供的两条参考序列，重新比对并检测结构变异；
* 完成Delly结果与IGV联合可视化展示，重点验证是否存在跨人类染色体与病毒序列的BND变异；
* 梳理Delly指令及参数配置方法，整理为可复用脚本；
* 精读论文尚未开始，明天要加把劲了。
