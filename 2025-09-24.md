🧬 实习日志 第36天｜Python 环境管理、绘图与 I/O 调试实战

**日期：2025年9月24日**
**地点：首都医科大学生信实验室 / VS Code + iTerm2（Mac）**

---

💡 今日完成的工作：

**1. 理清并修复 Python 环境问题（conda / venv / VS Code 对齐）**

* 确认 `bioinfo`（conda）与项目内 `.venv`、系统 Python 并存的状态；定位 VS Code Debug 调用的是 `/usr/bin/python3` 而非期望的 `bioinfo` 环境；
* 在终端验证 `python -c "import sys; print(sys.executable)"`，并用 `conda info --envs` / `which python` 确认环境路径；
* 切换 VS Code 解释器到 `/Users/shenyz/miniconda3/envs/bioinfo/bin/python`，并重启终端与 Debug，解决调试时找不到已安装包的问题（matplotlib / openpyxl）；

**2. 安装并验证绘图库与 Excel 后端**

* 在 `bioinfo` 环境中通过 `conda install -c conda-forge matplotlib openpyxl`（或 `python -m pip install`）安装/验证包；
* 运行测试脚本生成 `plot_test.png` 并成功执行 `df.to_excel("output.xlsx")`，确认 pandas 与 openpyxl 协同可用；

**3. 熟练掌握文件路径与脚本工作目录的差异**

* 学会用 `os.getcwd()` 检查当前工作目录，也学会用 `script_dir = os.path.dirname(os.path.abspath(__file__))` + `os.path.join(script_dir, ...)` 来稳妥地按脚本所在目录读取/写入数据，避免相对路径混淆；

**4. 巩固 pandas/绘图/异常处理基础**

* 写并调试了 `safe_mean(series)`：理解 `Series` 对象、`series.mean()` 的含义，并加上 `try/except` 做基本错误处理；
* 理解并实践 `df[df["mean"] > 10]`（布尔索引）与 `df.loc[rows, cols]`（按标签索引）的区别；
* 用 `matplotlib.pyplot` 画图（线图/柱状图）、调整 `plt.xticks(rotation=45)`、设置 `figsize`、`tight_layout()`，并保存为 PNG/PDF；

**5. 写了小脚本并完成一次端到端运行**

* 从读取 CSV → 筛选 → 保存 CSV/Excel → 绘图 → 保存图像，形成一个可复现的小流程并测试通过；
* 在 VS Code 中用断点调试查看中间变量，掌握如何观察 `df.head()`、打印 `os.getcwd()`、确认包导入路径等。

---

📚 工作总结：

**技术能力提升方面**

* 明显提升了环境管理能力——能发现“已装包但仍报错”的根源（解释器不一致）并修复；
* 对 pandas 的索引/选择（布尔索引、`loc`、`iloc`）与 Series/ DataFrame 的区别更清晰；
* 掌握了 matplotlib 的基本绘图流程与保存参数（dpi、figsize、tight\_layout）；
* 熟悉了如何让脚本稳妥读取与写入与脚本同级的文件，减少路径相关错误。

**调试与工程化思路**

* 学会把问题拆成三步：确认解释器 → 确认包位于该解释器环境 → 在该环境下运行脚本验证；
* 养成把函数写成“传参式”（不依赖全局 `df`）以提高复用性与测试友好性的习惯。

---

❗ 当前存在的问题 / 风险：

* 机器上同时存在 `base`、`bioinfo`、`.venv`、以及系统 Python，容易混淆（需要统一管理或形成书面规则）；
* 部分项目依赖尚未形成 `requirements.txt` / `environment.yml`，复现性需要加强；
* 对于更复杂的数据（超大 CSV / 内存受限），还需练习 chunked 读取与性能优化（`pd.read_csv(..., chunksize=...)`）。

---

🎯 明日计划（可执行项）：

1. 把今天用到的依赖导出并固定：在 `bioinfo` 中运行 `conda env export > environment.yml` 或在 `.venv` 中 `pip freeze > requirements.txt`；
2. 把今天的小脚本封装成 CLI（`argparse`），并加入 `--data-dir` 参数与基于 `__file__` 的路径解析；
3. 写一个短 README，说明 VS Code 该如何选择解释器并启动 Debug（截图 + 具体步骤）；
4. 练习用 `pd.read_csv(..., chunksize=100000)` 处理大文件的简单范例，观察内存占用；
5. 将项目推到 GitHub（新建仓库，初始 commit 包括 `README`, `requirements.txt` / `environment.yml`, 示例数据和运行说明）。
